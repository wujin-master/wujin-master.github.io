---
title: '使用docker构建镜像'
date: 2023-11-19T17:37:06+08:00
lastmod: 2023-11-19T17:37:06+08:00
draft: false
---
# 使用docker构建镜像

## 一、Dockerfile构建过程
1. 先以FROM指定的基础镜像运行一个容器
2. 执行一条指令，对该容器进行修改
3. 就修改后的容器创建新的镜像层
4. 基于上一个镜像层，创建新的容器
5. 执行下一条指令，对新的容器进行修改
6. ...
7. 直至所有指令执行完毕
## 二、如何优化Dockerfile制作的镜像
由于Dockerfile是从FROM指定的基础镜像开始的，所以减小镜像体积的重要策略就是找到一个最小的基础镜像

docker会删除中间层创建的容器，但不会删除中间层镜像，所以减小中间层镜像数量就是一种有效的优化策略，如

将RUN等其他指令进行合并

分段构建